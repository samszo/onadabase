<?xml version="1.0" encoding="utf-8"?>
<!--
 Copyright 2008 MUNDIGO Inc. 
 Licensed under the Apache License, Version 2.0:
    http://www.apache.org/licenses/LICENSE-2.0
todo :
- http://livedocs.adobe.com/flex/3/html/help.html?content=charts_types_06.html#164059
  //<mx:Model id="EtatDiag" source="EtatDiag.xml"/>

-->
<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml"
  width="100%" height="100%" layout="absolute" viewSourceURL="srcview/index.html" 
  creationComplete="srvEtatDiag.send()" >

  <mx:HTTPService id="srvEtatDiag" url="http://localhost/onadabase/library/php/ExeAjax.php?f=GetStatEtatDiag"
  	result="rhEtatDiag(event);" />


 	<!-- Define custom colors for use as fills. -->
    <mx:SolidColor id="sc0" color="green" alpha=".8"/>
    <mx:SolidColor id="sc1" color="yellow" alpha=".8"/>
    <mx:SolidColor id="sc2" color="#ffa200" alpha=".6"/>
    <mx:SolidColor id="sc3" color="red" alpha=".6"/>

    <!-- Define custom Strokes for the columns. -->
    <mx:Stroke id="s0" color="green" weight="2"/>
    <mx:Stroke id="s1" color="yellow" weight="2"/>
    <mx:Stroke id="s2" color="#ffa200" weight="2"/>
    <mx:Stroke id="s3" color="red" weight="2"/>
 
  
 <mx:Panel title="ONADABASE" width="100%" height="100%">
  <mx:HBox>
      <mx:CheckBox selected="false" change="createMarkerGrille('66')"/>
      <mx:Label text="Territoire" color="{categories['grille_66'].color}"/>
      <mx:CheckBox selected="false" change="createMarkerGrille('55')"/>
      <mx:Label text="Etablissement" color="{categories['grille_55'].color}"/>
      <mx:CheckBox selected="false" change="createMarkerGrille('62')"/>
      <mx:Label text="Voirie" color="{categories['grille_62'].color}"/>
      <mx:CheckBox selected="false" change="createMarkerGrille('53')"/>
      <mx:Label text="Bâtiment" color="{categories['grille_53'].color}"/>
      <mx:CheckBox selected="false" change="createMarkerGrille('61')"/>
      <mx:Label text="Espace extérieur" color="{categories['grille_61'].color}"/>
      <mx:CheckBox selected="false" change="createMarkerGrille('58')"/>
      <mx:Label text="Parcelle" color="{categories['grille_58'].color}"/>
  </mx:HBox>
  <mx:HDividedBox width="100%" height="100%">
   <mx:VBox width="30%" height="100%" paddingLeft="5" paddingTop="5">
    <mx:Label id="traceUrl" text=""/>
    <mx:ColumnChart id="chart" 
        dataProvider="{rsEtatDiag.EtatDiag.Obstacles}" 
        type="stacked"
        showDataTips="true" 
        width="100%" 
        height="100%"
    >
        <mx:horizontalAxis>
            <mx:CategoryAxis id="h1" categoryField="id" />
        </mx:horizontalAxis>
        <mx:series>
           <mx:ColumnSeries 
                xField="id" 
                yField="niv0" 
                displayName="Critères valides"
				fill="{sc0}"
                stroke="{s0}"
           />
           <mx:ColumnSeries 
                xField="id" 
                yField="niv1" 
                displayName="Obstacles niveau 1"
				fill="{sc1}"
                stroke="{s1}"
           />
           <mx:ColumnSeries 
                xField="id" 
                yField="niv2" 
                displayName="Obstacles niveau 2"
				fill="{sc2}"
                stroke="{s2}"
           />
           <mx:ColumnSeries 
                xField="id" 
                yField="niv3" 
                displayName="Obstacles niveau 3"
				fill="{sc3}"
                stroke="{s3}"
           />
        </mx:series>
    </mx:ColumnChart>
    <mx:HBox>
		<mx:Image id="imgAlphaMoteur" source="{AIcon}" width="80" />
		<mx:Image id="imgAlphaAudio" source="{BIcon}" width="80" />
		<mx:Image id="imgAlphaCog" source="{CIcon}" width="80" />
		<mx:Image id="imgAlphaVisu" source="{DIcon}" width="80" />		
	</mx:HBox>
     <mx:Legend>
        <mx:LegendItem label="Critères valides" fontWeight="bold" fill="{sc0}" stroke="{s0}" />
        <mx:LegendItem label="Obstacles niveau 1" fontWeight="bold" fill="{sc1}" stroke="{s1}" />
        <mx:LegendItem label="Obstacles niveau 2" fontWeight="bold" fill="{sc2}" stroke="{s2}" />
        <mx:LegendItem label="Obstacles niveau 3" fontWeight="bold" fill="{sc3}" stroke="{s3}" />
     </mx:Legend>


   </mx:VBox>
   <mx:UIComponent id="mapHolder"
      initialize="onHolderCreated(event);"
      resize="onHolderResized(event)"
      width="70%" height="100%"/>
  </mx:HDividedBox>
 </mx:Panel>



<mx:Script source="onadaflex.as"/>

</mx:Application>